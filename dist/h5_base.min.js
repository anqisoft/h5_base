const CURRENT_URL=window.location.href;const HOME_URL=CURRENT_URL.startsWith("file:///")?CURRENT_URL.substring(0,CURRENT_URL.lastIndexOf("/")+1).concat("index.htm"):CURRENT_URL.split("/").splice(0,3).join("/").concat("/");const SITE_ROOT=HOME_URL.substring(0,HOME_URL.lastIndexOf("/")+1);const SITE_IMAGE_PATH=`${SITE_ROOT}images/`;const SITE_JAVASCRIPT_PATH=`${SITE_ROOT}js/`;const SITE_CSS_PATH=`${SITE_ROOT}css/`;const getPageParameterByName=(t,e)=>{const n=CURRENT_URL.replace("?","&");const o=`${t}=`;return n.indexOf(`&${o}`)===-1?e||"":decodeURIComponent(n.split("&").slice(1).filter(t=>t.startsWith(o))[0].split("=")[1])};const LANG_PROPERTY="edu-lang";const MONTH_FULL_NAME_ARRAY=["Monday","Tuseday","Wednesday","Thursday","Friday","Saturday","Sunday"];const MONTH_NAME_ARRAY=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"];function parsePageParamsFromUrl(o){window.anqiData=window.anqiData||{LANG:"en",THICKESS:"0.2",A3:false,LANDSCAPE:false,PAGE_PADDING_TOP:15,PAGE_PADDING_LEFT:10,PAPER_WIDTH:0,PAPER_HEIGHT:0,PAGE_WIDTH:0,PAGE_HEIGHT:0,NO:1,MM_TO_PX_SCALE:0,PX_TO_MM_SCALE:0};const t=window.anqiData;o=o.replace("?","&").toLowerCase();const i=o.split("&").slice(1);function e(t,e){const n=`${t}=`;if(o.indexOf(n)===-1)return e;return i.filter(t=>t.startsWith(`&${n}`))[0].split("=")[1]}const n=e("lang","en");const s=["en","zh_cn","zh_tw"].indexOf(n)===-1?"en":n;const r=Math.max(0,parseFloat(e("thickess","0.2")));const a=e("a3","true")==="true";const c=e("landscape","false")==="true";const l=Math.max(0,parseFloat(e("top","15")));const m=Math.max(0,parseFloat(e("left","10")));const u=Math.max(0,parseInt(e("no","1")));const g=parseFloat(e("width","0"))||(a?c?420:297:c?297:210);const d=parseFloat(e("height","0"))||(a?c?297:420:c?210:297);const p=g-m*2;const h=d-l*2;t.LANG=s;t.THICKESS=r;t.A3=a;t.LANDSCAPE=c;t.PAGE_PADDING_TOP=l;t.PAGE_PADDING_LEFT=m;t.PAPER_WIDTH=g;t.PAPER_HEIGHT=d;t.PAGE_WIDTH=p;t.PAGE_HEIGHT=h;t.NO=u;const A=new DPIHelper;t.MM_TO_PX_SCALE=A.getMmToPxScale();t.PX_TO_MM_SCALE=A.getPxToMmScale()}function getPageCss(){const{A3:t,LANDSCAPE:e,PAGE_PADDING_TOP:n,PAGE_PADDING_LEFT:o,PAGE_WIDTH:i,PAGE_HEIGHT:s}=window.anqiData;return`\@media print\{\@page\{size:${t?"A3":"A4"} ${e?"landscape":"portrait"};\} \}
*\{margin:0;border:0;padding:0;\}
page:not(:last-of-type)\{page-break-after:always;\}
page\{padding-top:${n}mm;padding-left:${o}mm;display:block;width:${i}mm;height:${s}mm;position:relative;overflow:hidden;\}`}function setF1Content(e){document.onkeydown=function(t){switch(t.keyCode){case 112:alert(e);t.preventDefault();t.stopPropagation();break;default:break}return false}}function getNumbersArray(e,n){const o=[];for(let t=e;t<=n;++t)o.push(t.toString());return o}const LOCAL_STORAGE_KEY_OF_LANG="lang";const LOCAL_STORAGE_KEY_OF_CURRENT_PAGE=CURRENT_URL.includes("?")?CURRENT_URL.split("?")[1]:CURRENT_URL;const CHANGE_LANG_NOTIFY_ARRAY=[];const getCurrentLang=()=>localStorage.getItem(LOCAL_STORAGE_KEY_OF_LANG)||"zh_cn";const setCurrentLang=t=>{getHtmlElement().setAttribute(LANG_PROPERTY,t);localStorage.setItem(LOCAL_STORAGE_KEY_OF_LANG,t);updateUIByCurrentLang()};const updateUIByCurrentLang=()=>{const e=getCurrentLang();CHANGE_LANG_NOTIFY_ARRAY.forEach(t=>t(e))};const getCurrentPageLocalStorage=()=>localStorage.getItem(LOCAL_STORAGE_KEY_OF_CURRENT_PAGE)||"";const setCurrentPageLocalStorage=t=>localStorage.setItem(LOCAL_STORAGE_KEY_OF_CURRENT_PAGE,t);const getChangeLangNotifyArrayOfCurrentPage=()=>CHANGE_LANG_NOTIFY_ARRAY;const clearChangeLangNotifyArrayOfCurrentPage=()=>{CHANGE_LANG_NOTIFY_ARRAY.length=0};class DPIHelper{dpiArray=[];dpiX=0;mmToPxScale=0;pxToMmScale=0;constructor(){const t=window.screen;const{dpiArray:e}=this;if(t.deviceXDPI){e.push(t.deviceXDPI);e.push(t.deviceYDPI)}else{const o=document.createElement("div");o.style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden";document.body.appendChild(o);e.push(parseInt(o.offsetWidth.toString()));e.push(parseInt(o.offsetHeight.toString()));document.body.removeChild(o)}const n=e[0];this.dpiX=n;this.mmToPxScale=n/25.4;this.pxToMmScale=25.4/n}convertPxToMm=t=>t/this.dpiX*25.4;convertMmToPx=t=>t/25.4*this.dpiX;getMmToPxScale=()=>this.mmToPxScale;getPxToMmScale=()=>this.pxToMmScale}function isI18nable(t){return typeof t!=="undefined"&&t!==null&&typeof t!=="string"&&typeof t.en==="string"&&typeof t.zh_cn==="string"&&typeof t.zh_tw==="string"}function hide(t){if(t)t.style.display="none"}function showBlock(t){if(t)t.style.display="block"}function showInlineBlock(t){if(t)t.style.display="inline-block"}function showFlex(t){if(t)t.style.display="flex"}function showInlineFlex(t){if(t)t.style.display="inline-flex"}function getElementById(t){return document.getElementById(t)}function getElementByIdAndTagName(t,e){return document.getElementById(t)}function querySelectorAll(t){return document.querySelectorAll(t)}function querySelectorAllByI18n(){return document.querySelectorAll("[i18n]")}function querySelectorAllByI18nPlaceholder(){return document.querySelectorAll("[i18n-placeholder]")}function getElementsByTagName(t){return document.getElementsByTagName(t)}function getHeadElement(){return document.getElementsByTagName("head")[0]}function getHtmlElement(){return document.getElementsByTagName("html")[0]}function getBodyElement(){return document.getElementsByTagName("body")[0]}function getTitleElement(){return document.getElementsByTagName("title")[0]}function getHeaderElement(){return document.getElementsByTagName("header")[0]}function getFooterElement(){return document.getElementsByTagName("footer")[0]}function getMainElement(){return document.getElementsByTagName("main")[0]}function createElement(t,e){return document.createElement(t,e)}function setAttributesOfA(t,e){t.setAttribute("href",e);if(!e.startsWith("mailto:")){t.setAttribute("target","_blank")}}function stopEventBubble(t){t.cancelBubble=true;t.preventDefault();t.stopPropagation();return false}function getI18nInnerHTML({en:t,zh_cn:e,zh_tw:n}){return`<en>${t}</en><zh_cn>${e}</zh_cn><zh_tw>${n}</zh_tw>`}function getI18nInnerHTMLFromDate(t){const e=`${MONTH_NAME_ARRAY[t.getMonth()]} ${t.getDate()}, ${t.getFullYear()}`;const n=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`;const o=n;return`<en>${e}</en><zh_cn>${n}</zh_cn><zh_tw>${o}</zh_tw>`}function createPageElement(){return document.createElement("page")}function createSvgElement(t,e,n){const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.innerHTML=t;o.setAttribute("version","1.1");o.setAttribute("xmlns","http://www.w3.org/2000/svg");o.setAttribute("width",`${e}mm`);o.setAttribute("height",`${n}mm`);return{svgElement:o,width:e,height:n}}function createSvgGElement(t,e,n){const o=document.createElementNS("http://www.w3.org/2000/svg","g");o.innerHTML=t;o.setAttribute("width",`${e}mm`);o.setAttribute("height",`${n}mm`);return{gElement:o,width:e,height:n}}function createSvgAndGElement({html:t,width:e,height:n}){const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("version","1.1");o.setAttribute("xmlns","http://www.w3.org/2000/svg");o.setAttribute("width",`${e}mm`);o.setAttribute("height",`${n}mm`);const i=createSvgGElement(t,e,n).gElement;o.appendChild(i);return{svgElement:o,gElement:i,width:e,height:n}}function appendSvgAndG(t,e,n){const{abs:o,sin:i,cos:s,PI:r}=Math;const{svgElement:a,gElement:c,width:l,height:m}=e;const{left:u,right:g,top:d,bottom:p,degree:h}=n;const{PAGE_WIDTH:A,PAGE_HEIGHT:f}=window.anqiData;const _="undefined"!==typeof u?u:A-l-g;const E="undefined"!==typeof d?d:f-m-p;t.appendChild(a);a.setAttribute("x",`${_}mm`);a.setAttribute("y",`${E}mm`);if(!h)return;c.setAttribute("transform",`rotate(${h})`);c.style.transformOrigin="50% 50%";if(h===180||h===-180)return;let T=0,S=0,b=1,y=1,w=1,N=1;if(h<=-90){const x=-90-h;const O=r*x/180;T=l*i(O)+m*s(O);S=l*s(O)+m*i(O);w=-1;N=-1;b=-1;y=1}else if(h<0){const x=-h;const O=r*x/180;T=l*s(O)+m*i(O);S=l*i(O)+m*s(O);w=-1;N=1;b=1;y=1}else if(h<=90){const O=r*h/180;T=l*s(O)+m*i(O);S=l*i(O)+m*s(O);w=-1;N=-1;b=1;y=-1}else if(h<180){const x=h-90;const O=r*x/180;T=l*s(O)+m*i(O);S=l*i(O)+m*s(O);w=-1;N=1;b=1;y=1}const P=T-l;const $=S-m;const L=P*.5;const R=$*.5;const I=L*b;const G=R*y;if(T<0||S<0){console.log({degree:h,cos:s(h),sin:i(h),newWidth:T,newHeight:S,x:_,HALF_DELTA_WIDTH:L,fixValueByRight:"undefined"!==typeof g?2:1,newX:_+L*("undefined"!==typeof g?2:1),y:E,HALF_DELTA_HEIGHT:R,newY:E+R,G_DELTA_X:I,G_DELTA_Y:G})}a.setAttribute("width",`${T}mm`);a.setAttribute("height",`${S}mm`);a.setAttribute("x",`${_+L*w*("undefined"!==typeof g?2:1)}mm`);a.setAttribute("y",`${E+R*N}mm`);c.style.translate=`${I}mm ${G}mm`}function createTopSvgElement(){const{PAGE_WIDTH:t,PAGE_HEIGHT:e}=window.anqiData;const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("version","1.1");n.setAttribute("width",`${t}mm`);n.setAttribute("height",`${e}mm`);return n}const SVG_NS="http://www.w3.org/2000/svg";const SVG_XLINKNS="http://www.w3.org/1999/xlink";class SvgHelper{static createSvg=()=>{const t=document.createElementNS(SVG_NS,"svg");t.setAttribute("version","1.1");t.setAttribute("xmlns",SVG_NS);t.setAttribute("xmlns:xlink",SVG_XLINKNS);return t};static createSvgPath=()=>{return document.createElementNS(SVG_NS,"path")};static appendLine(t,e,n,o,i,s,r){const a=document.createElementNS(SVG_NS,"line");a.setAttribute("x1",`${n}mm`);a.setAttribute("x2",`${o}mm`);a.setAttribute("y1",`${i}mm`);a.setAttribute("y2",`${s}mm`);if(r){r.left=Math.min(r.left,n,o);r.right=Math.max(r.right,n,o);r.top=Math.min(r.top,i,s);r.bottom=Math.max(r.bottom,i,s)}a.setAttribute("style",e);t.appendChild(a)}static appendCircle(t,e,n,o,i,s){const r=document.createElementNS(SVG_NS,"circle");r.setAttribute("cx",`${n}mm`);r.setAttribute("cy",`${o}mm`);r.setAttribute("r",`${i}mm`);r.setAttribute("fill","#ffffff");if(s){s.left=Math.min(s.left,n-i);s.right=Math.max(s.right,n+i);s.top=Math.min(s.top,o-i);s.bottom=Math.max(s.bottom,o+i)}r.setAttribute("style",e);t.appendChild(r)}static appendTspan(t,e,n,o,i){if(typeof o==="number"){o=`${o}mm`}if(typeof i==="number"){i=`${i}mm`}const s=document.createElementNS(SVG_NS,"tspan");s.setAttribute("dx",`${o}`);s.setAttribute("dy",`${i}`);s.setAttribute("style",e.concat("dominant-baseline:middle;text-anchor:middle;",n==="6"||n==="9"?"text-decoration:underline;":"",n==="ü"?"opacity:0.85;font-size:0.9em;":""));s.innerHTML=n;t.appendChild(s)}static appendText(t,e,o,n,i,s,r,a,c=false){const l=document.createElementNS(SVG_NS,"text");l.setAttribute("x",`${n}mm`);l.setAttribute("y",`${i}mm`);t.appendChild(l);if(isI18nable(o)){o=o;o=`<en>${o.en}</en><zh_cn>${o.zh_cn}</zh_cn><zh_tw>${o.zh_tw}</zh_tw>`}o=o;if(o.indexOf("<en>")>-1){const m=getCurrentLang();const u=`<${m}>`;const g=`</${m}>`;if(o.indexOf(u)>-1){o=o.split(u)[1].split(g)[0]}}o=o.replace(/<br \/>/gi,"<br/>").replace(/<br\/>/gi,"<br>").replace(/\\n/gi,"<br>");if(o.indexOf("<br>")>-1){const d=e.indexOf("font-size:")>-1?e.split("font-size:")[1].split(";")[0]:"2mm";const p=d.replace(/[0-9.]/gi,"");const h=parseFloat(d.replace(p,""));const A=o.split("<br>");let n=0;const f=`${h}${p}`;A.forEach((t,e)=>{SvgHelper.appendTspan(l,"",t,e?`-${n}em`:"0",e?f:"0");n=t.length})}else{if(c){o.split("").forEach((t,e)=>{SvgHelper.appendTspan(l,"",t,"0","0")})}else{SvgHelper.appendTspan(l,"",o,"0","0")}}if(a){const _=l.getClientRects();const{left:E,right:T,top:S,bottom:b}=_.length?_.item(0):l.getBoundingClientRect();a.left=Math.min(a.left,E,T);a.right=Math.max(a.right,E,T);a.top=Math.min(a.top,S,b);a.bottom=Math.max(a.bottom,S,b)}e=e.concat("dominant-baseline:middle;text-anchor:middle;".concat(s?`transform: rotate(${s}deg);transform-origin:${n}mm ${i}mm;`:""));l.setAttribute("style",e)}static setSvgTextInfo(t,e,n,o){t.x=e;t.y=n;t.rotate=o}static appendOuterPath(t,e,n,o,i){t.setAttribute("width",`${e}mm`);t.setAttribute("height",`${n}mm`);const s=o*e;const r=o*n;const a=SvgHelper.createSvgPath();a.setAttribute("fill","none");a.setAttribute("stroke",i);a.setAttribute("d",`M 0, 0 `.concat(`h ${s} `,`v ${r} `,`h -${s} `," z"));t.appendChild(a)}static appendOuterLine(t,e,n,o){t.setAttribute("width",`${e}mm`);t.setAttribute("height",`${n}mm`);const{appendLine:i}=SvgHelper;i(t,o,0,e,0,0,null);i(t,o,0,e,n,n,null);i(t,o,0,0,0,n,null);i(t,o,e,e,0,n,null)}static getTextStyleFontSizePatchCss(t,e){if(t>99&&e.indexOf("font-size:")>-1){const n=e.split("font-size:")[1].split(";")[0];const o=n.replace(/[0-9\.\-]/g,"");const i=parseFloat(n.replace(o,""));return`font-size:${i*2/t.toString().length}${o};`}return""}}